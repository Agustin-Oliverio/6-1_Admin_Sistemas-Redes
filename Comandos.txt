COMANDOS

enable
configure terminal


VLAN SWITCH
vlan 50
name GUEST_NET
interface range fa 0/17-18
switchport access vlan 50
exit


VLAN (ROUTER)
interface gigabitEthernet 0/0/0.50
description GUEST_NET
no shutdown
encapsulation dot1Q 50
ip address 198.51.100.225 255.255.255.240
exit


ROUTER DHCP
ip dhcp POOL SERVERS_NET
dns-server 69.13.5.67
network 198.51.100.240 255.255.255.240
default-router 198.51.100.241
exit
ip dhcp excluded-address 198.51.100.241


SERVIDOR DHCP
interface gigabitEthernet0/0/0.50
ip helper-address 203.0.113.98
exit


TUNEL GRE
interface Tunnel1
ip address 10.10.10.2 255.255.255.252
tunnel source Serial0/1/0
tunnel destination 23.10.0.1


VPN
crypto isakmp policy 10
authentication pre-share
hash sha
encryption aes 256
group 2
lifetime 86400
exit
crypto isakmp key gonzalini address 23.10.0.2
crypto ipsec transform-set management esp-aes esp-sha-hmac
access-list 101 permit ip 172.20.5.0 0.0.0.31 203.0.113.0 0.0.0.31
crypto map managerMap 10 ipsec-isakmp
set peer 23.10.0.2
match address 101
set transform-set management
exit
interface serial 0/1/0
crypto map managerMap
do wr
exit


crypto isakmp policy 10
authentication pre-share
hash sha
encryption aes 256
group 2
lifetime 86400
exit
crypto isakmp key gonzalini address 23.10.0.1
crypto ipsec transform-set management esp-aes esp-sha-hmac
access-list 101 permit ip 203.0.113.0 0.0.0.31 172.20.5.0 0.0.0.31
crypto map managerMap 10 ipsec-isakmp
set peer 23.10.0.1
match address 101
set transform-set management
exit
interface serial 0/1/0
crypto map managerMap
do wr
exit





crypto isakmp policy 10
authentication pre-share
hash sha
encryption aes 256
group 2
lifetime 86400
exit
crypto isakmp key skibidi address 23.10.0.2
crypto ipsec transform-set servers esp-aes esp-sha-hmac
access-list 102 permit ip 172.20.5.96 0.0.0.31 203.0.113.96 0.0.0.31
crypto map serversMap 10 ipsec-isakmp
set peer 23.10.0.2
match address 102
set transform-set servers
exit
interface serial 0/1/0
crypto map serversMap
do wr
exit


crypto isakmp policy 10
authentication pre-share
hash sha
encryption aes 256
group 2
lifetime 86400
exit
crypto isakmp key skibidi address 23.10.0.1
crypto ipsec transform-set servers esp-aes esp-sha-hmac
access-list 102 permit ip 203.0.113.96 0.0.0.31 172.20.5.96 0.0.0.31
crypto map serversrMap 10 ipsec-isakmp
set peer 23.10.0.1
match address 102
set transform-set servers
exit
interface serial 0/1/0
crypto map serversMap
do wr
exit





crypto isakmp policy 10
authentication pre-share
hash sha
encryption aes 256
group 2
lifetime 86400
exit
crypto isakmp key mondongo address 23.10.0.2
crypto ipsec transform-set staff esp-aes esp-sha-hmac
access-list 103 permit ip 172.20.5.32 0.0.0.31 203.0.113.32 0.0.0.31
crypto map staffMap 10 ipsec-isakmp
set peer 23.10.0.2
match address 103
set transform-set staff
exit
interface serial 0/1/0
crypto map staffMap
do wr
exit


crypto isakmp policy 10
authentication pre-share
hash sha
encryption aes 256
group 2
lifetime 86400
exit
crypto isakmp key mondongo address 23.10.0.1
crypto ipsec transform-set staff esp-aes esp-sha-hmac
access-list 103 permit ip 203.0.113.32 0.0.0.31 172.20.5.32 0.0.0.31
crypto map staffMap 10 ipsec-isakmp
set peer 23.10.0.1
match address 103
set transform-set staff
exit
interface serial 0/1/0
crypto map staffMap
do wr
exit



ACLs
interface gigabitEthernet0/0/0.30
ip access-group 30 out
exit

access-list 50 permit 172.20.5.128 0.0.0.31
access-list 50 permit 172.20.5.96 0.0.0.31
access-list 50 permit 203.0.113.128 0.0.0.31
access-list 50 permit 203.0.113.96 0.0.0.31
access-list 50 permit 198.51.100.240 0.0.0.15
access-list 50 permit 69.13.5.0 0.0.0.255
access-list 50 deny any
